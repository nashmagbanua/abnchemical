<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ABN-Chemical-LOgbook</title>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon-16x16.png">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .btn-tap:active { transform: scale(0.95); }
        ::-webkit-scrollbar { display: none; }
        body { 
    /* Gradient overlay para luminaw ang text (Mint White effect) */
    background-image: linear-gradient(rgba(240, 249, 246, 0.9), rgba(240, 249, 246, 0.9)), 
                      url('./assets/bg.jpg');
    background-size: cover; 
    background-position: center; 
    background-attachment: fixed;
    background-repeat: no-repeat;
}

/* Dagdag pogi point: Siguraduhin nating transparent ang ibang sections 
   para lumitaw ang background image */
#main-ui, #area-screen {
    background: transparent;
}
        /* Green Theme Tab Active */
        .tab-active { border-bottom: 4px solid #059669; color: #059669; font-weight: 900; }
        .admin-hidden { display: none !important; }
        .badge-pulse { animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        #summary-modal { z-index: 9999 !important; }
    </style>
</head>
<body class="bg-[#f0f9f6] text-slate-900 font-sans min-h-screen">

    <div class="p-6 bg-white/80 backdrop-blur-md border-b border-emerald-100 flex justify-between items-center sticky top-0 z-40 shadow-sm">
        <div>
            <h1 class="text-xl font-black italic uppercase text-emerald-900 tracking-tighter">CHEMICAL<span class="text-emerald-500">LOGBOOK</span></h1>
            <p id="display-date" class="text-[9px] font-black text-emerald-400 tracking-widest uppercase mt-1"></p>
        </div>
        <div class="flex items-center space-x-2">
            <div class="relative">
                <button onclick="showShiftSummary()" class="bg-emerald-50 text-emerald-700 p-2.5 rounded-full btn-tap border border-emerald-100">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                </button>
                <div id="summary-badge" class="hidden absolute -top-1 -right-1 bg-emerald-500 w-3 h-3 rounded-full border-2 border-white"></div>
            </div>
            <div class="relative">
                <button onclick="openAdmin()" class="bg-emerald-900 text-white text-[10px] px-5 py-2.5 rounded-full font-black uppercase btn-tap shadow-lg shadow-emerald-200">Visor Panel</button>
                <div id="notif-badge" class="hidden absolute -top-2 -right-1 bg-red-600 text-white text-[9px] font-black w-5 h-5 rounded-full flex items-center justify-center border-2 border-white badge-pulse">0</div>
            </div>
        </div>
     </div>
    <div id="main-ui">
        <div id="area-screen" class="p-6 grid grid-cols-2 gap-4">
            <h2 class="col-span-2 text-[10px] font-black text-emerald-800/40 uppercase tracking-[0.3em] mb-4 italic text-center">Select Plant Area</h2>
            
            <button onclick="selectArea('BOILER')" class="bg-white p-8 rounded-[2.5rem] shadow-sm border-2 border-emerald-50 btn-tap flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#065f46" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z"/></svg>
                <span class="block font-black text-[11px] uppercase mt-3 tracking-tighter text-emerald-900">Boiler</span>
            </button>

            <button onclick="selectArea('WTP')" class="bg-white p-8 rounded-[2.5rem] shadow-sm border-2 border-emerald-50 btn-tap flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#065f46" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-6.5c-.5 2.5-2 4.9-4 6.5C6 11.1 5 13 5 15a7 7 0 0 0 7 7z"/></svg>
                <span class="block font-black text-[11px] uppercase mt-3 tracking-tighter text-emerald-900">WTP</span>
            </button>

            <button onclick="selectArea('WWTP')" class="bg-white p-8 rounded-[2.5rem] shadow-sm border-2 border-emerald-50 btn-tap flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#065f46" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z"/><path d="M7 2v20"/><path d="M17 2v20"/><path d="M2 12h20"/><path d="M2 7h5"/><path d="M2 17h5"/><path d="M17 17h5"/><path d="M17 7h5"/></svg>
                <span class="block font-black text-[11px] uppercase mt-3 tracking-tighter text-emerald-900">WWTP</span>
            </button>

            <button onclick="selectArea('OTHERS')" class="bg-white p-8 rounded-[2.5rem] shadow-sm border-2 border-emerald-50 btn-tap flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#065f46" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="m7.5 4.27 9 5.15"/><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22V12"/></svg>
                <span class="block font-black text-[11px] uppercase mt-3 tracking-tighter text-emerald-900">Others</span>
            </button>
            <footer class="col-span-2 text-center py-10">
            <p class="text-[10px] font-black uppercase tracking-[0.2em] text-emerald-800/20">
                &copy; <span id="currentYear"></span> Nutribev Corporation â€¢ All rights reserved
            </p>
        </footer>
        </div>

        <div id="chem-screen" class="p-6 hidden">
            <div class="flex justify-between items-center mb-6">
                <h2 id="selected-area-label" class="text-lg font-black text-emerald-900 uppercase italic"></h2>
                <button onclick="goBack()" class="bg-emerald-100 text-emerald-700 text-[9px] px-4 py-2 rounded-full font-black uppercase">Back</button>
            </div>
            <div id="chem-grid" class="grid grid-cols-2 gap-4"></div>
        </div>
    </div>

    <div id="admin-dashboard" class="admin-hidden fixed inset-0 bg-white z-[100] flex flex-col overflow-hidden">
        <div class="p-6 border-b border-emerald-100 bg-white shrink-0">
            <div class="flex justify-between items-center mb-4">
                <h2 class="font-black text-xl italic uppercase text-emerald-900 tracking-tighter">VISOR <span class="text-emerald-500">PANEL</span></h2>
                <div class="flex space-x-2">
                    <button onclick="toggleDeliveryForm()" class="bg-emerald-600 text-white p-2 px-4 rounded-xl font-black text-[10px] uppercase btn-tap">+ Stock</button>
                    <button onclick="closeAdmin()" class="bg-emerald-50 p-2 px-4 rounded-xl text-emerald-700 font-black text-[10px] uppercase">Close</button>
                </div>
            </div>

            <div id="delivery-form" class="hidden bg-emerald-50 p-4 rounded-3xl mb-4 border border-emerald-100">
                <div class="grid grid-cols-2 gap-2 mb-2">
                    <select id="admin-chem-select" class="p-3 rounded-2xl bg-white border border-emerald-200 text-[10px] font-black outline-none"></select>
                    <input type="number" id="admin-qty" placeholder="Qty" class="p-3 rounded-2xl bg-white border border-emerald-200 font-black text-center text-[10px]">
                </div>
                <input type="text" id="admin-receiver" placeholder="Received By..." class="w-full p-3 rounded-2xl bg-white border border-emerald-200 font-black text-[10px] mb-2 uppercase italic">
                <button onclick="adminAddStock()" class="w-full bg-emerald-700 text-white p-3 rounded-2xl font-black text-[10px] uppercase">Submit Delivery</button>
            </div>

            <div class="flex border-b border-emerald-50 text-[10px] font-black uppercase tracking-widest text-emerald-300">
                <button onclick="setLogTab('OUT')" id="tab-OUT" class="flex-1 py-3 tab-active">Usage</button>
                <button onclick="setLogTab('IN')" id="tab-IN" class="flex-1 py-3">Deliveries</button>
                <button onclick="setLogTab('STATS')" id="tab-STATS" class="flex-1 py-3">Analytics</button>
            </div>
        </div>
        <div id="filter-bar" class="p-4 bg-[#f0f9f6] border-b border-emerald-100 space-y-2"></div>
        <div id="admin-content-area" class="flex-1 overflow-y-auto p-4 bg-[#f0f9f6]"></div>
    </div>

    <div id="summary-modal" class="hidden fixed inset-0 flex items-center justify-center p-6 backdrop-blur-sm bg-emerald-900/40">
        <div class="bg-white w-full max-w-md rounded-[2.5rem] p-8 shadow-2xl relative border-t-8 border-emerald-600">
            <h3 class="font-black text-center uppercase italic mb-4 text-emerald-900">Shift Summary</h3>
            <div id="summary-text" class="bg-emerald-50 p-6 rounded-3xl text-[11px] font-bold text-emerald-800 mb-6 border border-emerald-100 whitespace-pre-wrap max-h-[350px] overflow-y-auto"></div>
            <div class="grid grid-cols-2 gap-3">
                <button onclick="closeSummary()" class="bg-emerald-50 p-4 rounded-2xl font-black text-[10px] uppercase text-emerald-700 btn-tap">Close</button>
                <button onclick="copyReport()" class="bg-emerald-600 text-white p-4 rounded-2xl font-black text-[10px] uppercase shadow-lg btn-tap">Copy Report</button>
            </div>
        </div>
    </div>
 <script>
        let logs = JSON.parse(localStorage.getItem('chem_final_v16')) || [];
        let chemicals = [
            { id: 'hydro', name: 'Hydrologic Acid', unit: 'Cby', balance: 50, alert: 10 },
            { id: 'caustic', name: 'Caustic Soda', unit: 'Cby', balance: 50, alert: 10 },
            { id: 'chlorine', name: 'Chlorine', unit: 'Cby', balance: 40, alert: 10 },
            { id: 'alum', name: 'Aluminium Sulphate', unit: 'kg', balance: 250, alert: 50 },
            { id: 'amphos', name: 'Ammonium Phosphate', unit: 'kg', balance: 250, alert: 50 },
            { id: 'polymer', name: 'Polymer', unit: 'kg', balance: 100, alert: 25 }
        ];

        let activeTab = 'OUT';
        let currentArea = null;

        function getToday() { return new Date().toISOString().split('T')[0]; }

        function init() {
            document.getElementById('display-date').innerText = `${new Date().toLocaleDateString('en-US', {month:'short', day:'numeric', year:'numeric'})}`;
            const savedStock = JSON.parse(localStorage.getItem('chem_v16_stock'));
            if(savedStock) chemicals.forEach(c => c.balance = savedStock[c.id] ?? c.balance);
            document.getElementById('admin-chem-select').innerHTML = chemicals.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
            updateNotifBadge();
        }

        function applyFilters() {
            const container = document.getElementById('admin-content-area');
            const dt = document.getElementById('f-date').value;
            const currentMonth = new Date().toISOString().slice(0, 7); 
            let d = logs.filter(l => l.type === activeTab);

            if(dt) d = d.filter(l => l.date === dt);
            else d = d.filter(l => l.date.startsWith(currentMonth));

            if (activeTab === 'OUT') {
                const ch = document.getElementById('f-chem').value;
                const ar = document.getElementById('f-area').value;
                if(ch !== 'ALL') d = d.filter(l => l.chemId === ch);
                if(ar !== 'ALL') d = d.filter(l => l.area === ar);
                
                container.innerHTML = `
                    <p class="text-[8px] font-black uppercase text-emerald-600/50 mb-2 px-4">${dt ? 'Date: '+dt : 'Monthly View: '+currentMonth}</p>
                    <div class="bg-white rounded-[2.5rem] border border-emerald-100 overflow-hidden shadow-sm">
                        <div class="grid grid-cols-3 bg-emerald-50/50 p-4 text-[8px] font-black uppercase text-emerald-400"><span>Chemical</span><span>Area</span><span class="text-right">Qty</span></div>
                        ${d.length ? d.map(l => `<div class="grid grid-cols-3 p-4 border-b border-emerald-50 text-[10px] font-bold uppercase last:border-0"><span>${l.chemName}</span><span class="text-emerald-500 italic">${l.area}</span><span class="text-right font-black text-emerald-900">-${l.qty}</span></div>`).join('') : '<div class="p-10 text-center text-emerald-200 text-[10px] font-black italic">No Records</div>'}
                    </div>`;
            } else {
                const rcv = document.getElementById('f-rcv').value.toUpperCase();
                if(rcv) d = d.filter(l => l.receivedBy.toUpperCase().includes(rcv));

                container.innerHTML = `
                    <p class="text-[8px] font-black uppercase text-emerald-600/50 mb-2 px-4">${dt ? 'Date: '+dt : 'Monthly View: '+currentMonth}</p>
                    <div class="bg-white rounded-[2.5rem] border border-emerald-100 overflow-hidden shadow-sm">
                        <div class="grid grid-cols-4 bg-emerald-50/50 p-4 text-[8px] font-black uppercase text-emerald-400"><span>Date</span><span>Chem</span><span>Qty</span><span>By</span></div>
                        ${d.length ? d.map(l => `<div class="grid grid-cols-4 p-4 border-b border-emerald-50 text-[9px] font-bold uppercase last:border-0 italic"><span class="text-emerald-300">${l.date.split('-').slice(1).join('/')}</span><span>${l.chemName}</span><span class="text-emerald-700">+${l.qty}</span><span class="truncate">${l.receivedBy}</span></div>`).join('') : '<div class="p-10 text-center text-emerald-200 text-[10px] font-black">No Deliveries</div>'}
                    </div>`;
            }
        }

        function renderFilterBar() {
            const bar = document.getElementById('filter-bar');
            if (activeTab === 'STATS') { bar.classList.add('hidden'); return; }
            bar.classList.remove('hidden');
            if (activeTab === 'OUT') {
                bar.innerHTML = `<div class="flex space-x-2"><input type="date" id="f-date" onchange="applyFilters()" class="flex-1 p-2 rounded-xl text-[10px] font-black border border-emerald-200 uppercase bg-white"></div><div class="grid grid-cols-2 gap-2"><select id="f-chem" onchange="applyFilters()" class="p-2 rounded-xl text-[9px] font-black border border-emerald-200 bg-white"><option value="ALL">ALL CHEMICALS</option>${chemicals.map(c => `<option value="${c.id}">${c.name.toUpperCase()}</option>`).join('')}</select><select id="f-area" onchange="applyFilters()" class="p-2 rounded-xl text-[9px] font-black border border-emerald-200 bg-white"><option value="ALL">ALL AREAS</option><option value="BOILER">BOILER</option><option value="WTP">WTP</option><option value="WWTP">WWTP</option><option value="OTHERS">OTHERS</option></select></div>`;
            } else {
                bar.innerHTML = `<div class="flex space-x-2"><input type="date" id="f-date" onchange="applyFilters()" class="flex-1 p-2 rounded-xl text-[10px] font-black border border-emerald-200 bg-white"><input type="text" id="f-rcv" oninput="applyFilters()" placeholder="SEARCH RECEIVER..." class="flex-1 p-2 rounded-xl text-[9px] font-black border border-emerald-200 bg-white uppercase italic"></div>`;
            }
        }

        function renderStats(p) {
            const container = document.getElementById('admin-content-area');
            container.innerHTML = `<div class="bg-white p-6 rounded-[2.5rem] border border-emerald-100 shadow-sm mb-4"><div class="flex justify-between items-center mb-6"><h3 class="text-[10px] font-black uppercase text-emerald-800/40">Analytics</h3><select id="stat-p" onchange="renderStats(this.value)" class="text-[9px] font-black bg-emerald-50 p-2 rounded-xl border-none outline-none text-emerald-700"><option value="today">Today</option><option value="month">Month</option><option value="year">Year</option></select></div><div id="stats-chart" class="space-y-6"></div></div>`;
            document.getElementById('stat-p').value = p;
            const chart = document.getElementById('stats-chart');
            const now = new Date();
            let fl = logs.filter(l => l.type === 'OUT');
            if(p === 'month') fl = fl.filter(l => l.date.includes(`${now.getFullYear()}-${String(now.getMonth()+1).padStart(2,'0')}`));
            if(p === 'today') fl = fl.filter(l => l.date === getToday());
            const areas = ["BOILER", "WTP", "WWTP", "OTHERS"];
            chart.innerHTML = fl.length ? areas.map(area => {
                const aLogs = fl.filter(l => l.area === area);
                const total = aLogs.reduce((acc, curr) => acc + curr.qty, 0);
                const chemMap = {};
                aLogs.forEach(l => chemMap[l.chemName] = (chemMap[l.chemName] || 0) + l.qty);
                const maxVal = (p === 'year' ? 1000 : (p === 'month' ? 200 : 30));
                const perc = Math.min((total / maxVal) * 100, 100);
                return `<div><div class="flex justify-between text-[10px] font-black mb-1 uppercase"><span>${area}</span><span class="text-emerald-600">${total} Units</span></div><div class="bg-emerald-50 h-3 rounded-full overflow-hidden border border-emerald-100"><div class="bg-emerald-600 h-full rounded-full transition-all duration-1000" style="width: ${perc}%"></div></div><div class="flex flex-wrap gap-x-3 gap-y-1 mt-2">${Object.entries(chemMap).map(([n, q]) => `<span class="text-[8px] font-black text-emerald-400 uppercase italic">â€¢ ${n} (${q})</span>`).join('')}</div></div>`;
            }).join('') : `<div class="py-12 text-center text-emerald-100 text-[10px] font-black uppercase italic">No Data</div>`;
        }

        function setLogTab(t) { activeTab = t; ['OUT', 'IN', 'STATS'].forEach(id => document.getElementById('tab-'+id).classList.toggle('tab-active', id === t)); renderFilterBar(); if(t !== 'STATS') applyFilters(); else renderStats('today'); }
        function renderChems() { document.getElementById('chem-grid').innerHTML = chemicals.map(c => `<button onclick="tapSubtract('${c.id}')" class="bg-white p-6 rounded-[2.5rem] border-2 ${c.balance <= c.alert ? 'border-red-500 bg-red-50' : 'border-emerald-50'} btn-tap flex flex-col items-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#064e3b" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="mb-2"><path d="M10 2v8L4.72 20.55a1 1 0 0 0 .9 1.45h12.76a1 1 0 0 0 .9-1.45L14 10V2z"/><path d="M8.5 2h7"/><path d="M7 16h10"/></svg><span class="text-[8px] font-black uppercase text-emerald-800/40 mb-1 text-center truncate w-full">${c.name}</span><div class="text-[12px] font-black text-emerald-900">${c.balance} ${c.unit}</div></button>`).join(''); }
        function tapSubtract(chemId) { const chem = chemicals.find(c => c.id === chemId); let qty = 1; if(chem.type === 'weight') { const input = prompt(`KG used for ${chem.name}:`, "1"); if (input === null) return; qty = parseFloat(input); } if(!qty || qty <= 0 || chem.balance < qty) return alert("Invalid Stock!"); chem.balance -= qty; logs.unshift({id: Date.now(), date: getToday(), time: new Date().toLocaleTimeString(), chemId: chem.id, chemName: chem.name, area: currentArea, qty: qty, unit: chem.unit, type: 'OUT'}); saveData(); renderChems(); updateNotifBadge(); }
        function adminAddStock() { const id = document.getElementById('admin-chem-select').value; const qty = parseFloat(document.getElementById('admin-qty').value); const rcv = document.getElementById('admin-receiver').value; if(!qty || qty <= 0 || !rcv) return alert("Missing fields!"); const chem = chemicals.find(c => c.id === id); let finalAdd = chem.balance += (chem.unit === 'kg' ? qty * 25 : qty); logs.unshift({id: Date.now(), date: getToday(), time: new Date().toLocaleTimeString(), chemId: id, chemName: chem.name, qty: qty, receivedBy: rcv, unit: chem.unit === 'kg' ? 'Sacks' : 'Cby', type: 'IN'}); saveData(); updateNotifBadge(); document.getElementById('admin-qty').value = ""; document.getElementById('admin-receiver').value = ""; document.getElementById('delivery-form').classList.add('hidden'); if(activeTab === 'IN') applyFilters(); }
        function showShiftSummary() { const h = new Date().getHours(); const shift = (h >= 6 && h < 18) ? "DS" : "NS"; const todayLogs = logs.filter(l => l.date === getToday()); const usage = todayLogs.filter(l => l.type === 'OUT'); const delivery = todayLogs.filter(l => l.type === 'IN'); let res = `ðŸ“Œ SHIFT REPORT (${shift})\nDate: ${getToday()}\n\n--- USAGE ---\n`; if(usage.length) chemicals.forEach(c => { const used = usage.filter(l => l.chemId === c.id).reduce((acc, curr) => acc + curr.qty, 0); if(used > 0) res += `ðŸ”¹ ${c.name}: ${used} ${c.unit}\n`; }); else res += `(No usage)\n`; res += `\n--- DELIVERIES ---\n`; if(delivery.length) delivery.forEach(d => { res += `ðŸ“¦ ${d.chemName}: +${d.qty} (${d.receivedBy})\n`; }); else res += `(No deliveries)\n`; document.getElementById('summary-text').innerText = res; document.getElementById('summary-modal').style.display = 'flex'; document.getElementById('summary-badge').classList.add('hidden'); }
        function selectArea(a) { currentArea = a; document.getElementById('area-screen').classList.add('hidden'); document.getElementById('chem-screen').classList.remove('hidden'); document.getElementById('selected-area-label').innerText = a; renderChems(); }
        function goBack() { document.getElementById('area-screen').classList.remove('hidden'); document.getElementById('chem-screen').classList.add('hidden'); }
        function openAdmin() { document.getElementById('admin-dashboard').style.display='flex'; document.getElementById('admin-dashboard').classList.remove('admin-hidden'); setLogTab('OUT'); }
        function closeAdmin() { document.getElementById('admin-dashboard').style.display='none'; document.getElementById('admin-dashboard').classList.add('admin-hidden'); }
        function toggleDeliveryForm() { document.getElementById('delivery-form').classList.toggle('hidden'); }
        function closeSummary() { document.getElementById('summary-modal').style.display = 'none'; }
        function copyReport() { navigator.clipboard.writeText(document.getElementById('summary-text').innerText); alert("Copied!"); }
        function updateNotifBadge() { const low = chemicals.filter(c => c.balance <= c.alert).length; document.getElementById('notif-badge').innerText = low; document.getElementById('notif-badge').classList.toggle('hidden', low === 0); const count = logs.filter(l => l.date === getToday()).length; document.getElementById('summary-badge').classList.toggle('hidden', count === 0); }
        function saveData() { localStorage.setItem('chem_final_v16', JSON.stringify(logs)); const stock = {}; chemicals.forEach(c => stock[c.id] = c.balance); localStorage.setItem('chem_v16_stock', JSON.stringify(stock)); }
        init();
     document.getElementById('currentYear').textContent = new Date().getFullYear();
    </script>
</body>
</html>
